(this["webpackJsonpreact-game"]=this["webpackJsonpreact-game"]||[]).push([[0],{35:function(e,t,n){},37:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var i=n(2),s=n(3),r=n(4),a=n(8),o=n.n(a),c=0,h=function(){function e(t,n){Object(s.a)(this,e),this.id=c++,this.x=0,this.y=0,this.prevX=0,this.prevY=0,this.width=32,this.height=32,t&&(this.x=t),n&&(this.y=n),this.prevX=this.x,this.prevY=this.y}return Object(r.a)(e,[{key:"moveTo",value:function(e,t){this.prevX=this.x,this.prevY=this.y,this.x=e,this.y=t}},{key:"moveBy",value:function(e,t){this.moveTo(this.x+e,this.y+t)}},{key:"moveDir",value:function(e){switch(e){case"left":return this.moveBy(-1,0);case"right":return this.moveBy(1,0);case"up":return this.moveBy(0,-1);case"down":return this.moveBy(0,1);default:throw new Error("Unknown movement direction "+e)}}},{key:"isOutOfBounds",value:function(e,t){return this.x<0||this.y<0||this.x>=t||this.y>=e}},{key:"isCollidingWith",value:function(e){return this.isAt(e.x,e.y)}},{key:"isAt",value:function(e,t){return this.x===e&&this.y===t}},{key:"clone",value:function(){var t=new e;for(var n in this)if(this.hasOwnProperty(n)&&"id"!==n){var i=this[n];"function"!==typeof i&&(t[n]=i)}return t}}]),e}(),u=function(){function e(){Object(s.a)(this,e),this.mapWidth=16,this.mapHeight=16,this.tickDuration=200,this.tickTimer=0,this.score=0,this.highScore=Number(localStorage.getItem("game.highScore"))||0,this.tiles=[],this.apples=[],this.snake={movementDirection:"up",segments:[]},this.input={movementCommands:[]}}return Object(r.a)(e,[{key:"findEntityAt",value:function(e,t){var n,s=Object(i.a)(this.apples);try{for(s.s();!(n=s.n()).done;){var r=n.value;if(r.isAt(e,t))return r}}catch(h){s.e(h)}finally{s.f()}var a,o=Object(i.a)(this.snake.segments);try{for(o.s();!(a=o.n()).done;){var c=a.value;if(c.isAt(e,t))return c}}catch(h){o.e(h)}finally{o.f()}}},{key:"getRandomEmptyLocation",value:function(){for(var e;!e||this.findEntityAt(e.x,e.y);)e=this.getRandomLocation();return e}},{key:"getRandomLocation",value:function(){return{x:o()(this.mapWidth-1),y:o()(this.mapHeight-1)}}},{key:"inputMovementCommand",value:function(e){for(this.input.movementCommands.push(e);this.input.movementCommands.length>4;)this.input.movementCommands.shift()}},{key:"mapHeightPx",get:function(){return 32*this.mapHeight}},{key:"mapWidthPx",get:function(){return 32*this.mapWidth}},{key:"setScore",value:function(e){this.score=e,e>this.highScore&&(this.highScore=e,localStorage.setItem("game.highScore",this.highScore))}}]),e}();function m(e){e.tickDuration=120,e.tickTimer=0,e.score=0,e.highScore=Number(localStorage.getItem("game.highScore"))||0,e.input.movementCommands=["up"],e.tiles.length=0;for(var t=0;t<e.mapWidth;t++)for(var n=0;n<e.mapWidth;n++)e.tiles.push(new h(t,n));3!==e.apples.length&&(e.apples.length=0,e.apples.push(new h(0,0)),e.apples.push(new h(0,0)),e.apples.push(new h(0,0))),e.apples[0].moveTo(1,3),e.apples[1].moveTo(7,2),e.apples[2].moveTo(5,9),e.snake.movementDirection="up",e.snake.segments.length=0,e.snake.segments.push(new h(4,4)),e.snake.segments.push(new h(4,5)),e.snake.segments.push(new h(5,5)),e.snake.segments.push(new h(5,6)),e.snake.segments.push(new h(5,7))}var l=n(13),p=n.n(l);function v(e,t){e.tickTimer+=t,e.tickDuration*=.9999,e.tickTimer>=e.tickDuration&&(!function(e){(function(e){var t=e.input.movementCommands.shift();t&&(e.snake.movementDirection=t)})(e),function(e,t){e.segments[0].moveDir(t);for(var n=1;n<e.segments.length;n++){var i=e.segments[n-1];e.segments[n].moveTo(i.prevX,i.prevY)}}(e.snake,e.snake.movementDirection),function(e){e.snake.segments[0].isOutOfBounds(e.mapWidth,e.mapHeight)&&f(e)}(e),function(e){var t,n=e.snake.segments[0],s=Object(i.a)(e.snake.segments);try{for(s.s();!(t=s.n()).done;){var r=t.value;if(r!==n&&r.isCollidingWith(n))return f(e)}}catch(a){s.e(a)}finally{s.f()}}(e),function(e){var t,n=e.snake.segments[0],s=Object(i.a)(e.apples);try{for(s.s();!(t=s.n()).done;){var r=t.value;if(n.isCollidingWith(r))return d(e,r)}}catch(a){s.e(a)}finally{s.f()}}(e)}(e),e.tickTimer=0)}function f(e){m(e)}function d(e,t){e.setScore(e.score+1),e.apples.splice(e.apples.indexOf(t),1);var n=p()(e.snake.segments),i=n.clone();i.moveTo(n.prevX,n.prevY),e.snake.segments.push(i),function(e){var t=e.getRandomEmptyLocation(),n=t.x,i=t.y,s=new h(n,i);e.apples.push(s)}(e)}n(1);var g=n(14),y=n.n(g),k=(n(35),n(0));function j(e){var t=e.score;return Object(k.jsx)("div",{className:"Score",children:t})}n(37);function x(e){var t=e.entity,n=t.x*t.width,i=t.y*t.height;return Object(k.jsx)("div",{className:"Entity",style:{width:t.width,height:t.height,left:n,top:i}})}var b=n(15),O=n.n(b);n(44);function w(e){var t=e.game;return Object(k.jsxs)("div",{className:"Instructions",children:[Object(k.jsx)("p",{children:"use the arrow keys to move"}),Object(k.jsx)("p",{style:{position:"relative",top:0,left:-15},children:"eat apples!"}),t.highScore?Object(k.jsxs)("p",{children:["best ",t.highScore," apple",1===t.highScore?"":"s",O()("!",Math.round(t.highScore/5))]}):null,Object(k.jsx)("p",{style:{position:"relative",top:55,left:55},children:"don't bite yourself :O"})]})}n(45);function S(e){var t=e.game;return Object(k.jsxs)("div",{className:"Renderer",style:{width:t.mapWidthPx,height:t.mapHeightPx},children:[Object(k.jsxs)("ul",{className:"Renderer-entities Renderer-layer",children:[Object(k.jsx)("ul",{className:"Renderer-tiles Renderer-layer",children:t.tiles.map((function(e){return Object(k.jsx)(x,{entity:e},e.id)}))}),Object(k.jsx)("ul",{className:"Renderer-apples Renderer-layer",children:t.apples.map((function(e){return Object(k.jsx)(x,{entity:e},e.id)}))}),Object(k.jsx)("ul",{className:"Renderer-snake Renderer-layer",children:t.snake.segments.map((function(e){return Object(k.jsx)(x,{entity:e},e.id)}))})]}),Object(k.jsx)(j,{score:t.score}),0===t.score?Object(k.jsx)(w,{game:t}):null]})}n(46);function C(e){var t=e.game;return Object(k.jsx)("div",{className:"App",children:Object(k.jsx)(S,{game:t})})}var R=38,T=40,N=37,W=39;n(47);var D,A=window.game=new u;m(A),D=A,document.body.addEventListener("keydown",(function(e){!function(e,t){switch(t){case R:e.inputMovementCommand("up");break;case T:e.inputMovementCommand("down");break;case N:e.inputMovementCommand("left");break;case W:e.inputMovementCommand("right")}}(D,e.keyCode)})),window.cancelGameLoop=function(e){requestAnimationFrame((function i(s){if(!n)return;0!==t&&e(s-t);t=s,requestAnimationFrame(i)}));var t=0,n=!0;return function(){n=!1}}((function(e){v(A,e),function(e){y.a.render(Object(k.jsx)(C,{game:e}),document.getElementById("root"))}(A)}))}},[[48,1,2]]]);
//# sourceMappingURL=main.1e255127.chunk.js.map